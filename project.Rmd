---
title: "Spotify Top 100 Analysis"
author: "Juanrico Alvaro, Mikhael Enrico Setianto, Renaldo Fareza Tambunan"
date: "2022-07-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Group Members
1. Mikhael Enrico Setianto [702300] 
2. Juanrico Alvaro [702301]
3. Renaldo Fareza Tambunan [702314]

## 2. PROJECT REQUIREMENT
### 2.1 Introduction to the project
Spotify is the most well-known music streaming app in the world, users can access millions of songs and also many podcasts around the world. Nowadays, Spotify can be found on almost every device, especially among the millennials, because of its multi-platform apps and free to use.

Spotify is free, but for more convenient features the user can subscribe to Spotify Premium which the minimum cost around $10 per month. The features that the user can get as the premium user is the ability to disable ads and also unlimited songs skip. For this project, we are going to use Spotify daa to do some analysis.

### 2.2 Problems need to be solved
Spotify offer a dataset of all daily hit charts curated by Spotify that is published on Kaggle website ( [Visit Website](https://kaggle.com) ). The data will contain top 100 song from 2010 until 2019 with xslx data format and total 1000 total record for the past ten years. This dataset is still unprocessed and there is more room to do more exploratory and predictive data analysis.


### 2.3  Data analysis specifications
The objective of this system is to read the data in analysis manner with this functionality:

* Get top popular song genre for every 5 year
* Get top popular artist for every 5 year
* Get average duration each year
* Get artist which appeared on the charts maximum number of times
* Predict top genre next year

### 2.4  Project scope
The project will be revolving around descriptive and predictive analysis on Spotify. We are going to use R Programming as the programming language and R Studio as the IDE. Later will be delivered as HTML document generated by R Markdown.

## 3. DATA PREPARATION
### 3.1 Data acquiring
We will read the data from kaggle that has been given in csv format using read.csv
```{r}
df<-read.csv(file = "Spotify_2010_-_2019_Top_100.csv",header = TRUE, sep=",")
head(df,5)
nrow(df)
```

### 3.2 Data Cleaning
#### Removing NA value
check if there is NA value inside the dataframe.
```{r}
nrow(which(is.na(df), arr.ind=TRUE))
```
There are 36 position that is filled with NA value now we can remove those na value.
```{r}
df <- na.omit(df)
nrow(df)
```
#### Changing Date Release datatype
```{r}
df$added <- as.Date(df$added, "%d/%m/%Y")
df$added <- as.POSIXct(df$added)
sapply(df,class)
```

### 3.3 Data Transformation
#### simplify
Since we will do some prediction on genre it is better to classified the genre into a more simple one
```{r}
length(unique(df$top.genre))
```
as we can see there are hundreds of genre so we will classified it into 18 major genre. Here is our dictionary and implementation
```{r}
genre_dict <- c(
  "dance pop","pop", 
  "pop soul","soul",
  "atl hip hop","hip hop",
  "pop rap","rap",
  "big room","house",
  "canadian hip hop","hip hop",
  "disco house","house",
  "romanian house","house",
  'lilith',"indie",
  'detroit hip hop',"hip hop", 
  'asian american hip hop',"hip hop", 
  'east coast hip hop', "hip hop",
  'neo mellow',"pop", 
  'canadian pop',"pop", 
  'reggae fusion',"reggae", 
  'idol',"pop", 
  'art pop',"pop",
  "talent show","pop", 
  'modern alternative rock',"rock",
  'indietronica',"electronic", 
  'grime',"hip hop", 
  'barbadian pop',"pop", 
  'acoustic pop',"pop",
  'dutch house',"house", 
  'belgian pop',"pop", 
  'contemporary country',"country", 
  'boy band',"pop",
  'celtic rock',"rock", 
  'edm',"electronic", 
  'indie rock',"indie", 
  'australian dance',"dance",
  'british soul',"soul", 
  'eau claire indie',"indie", 
  'dancefloor dnb',"dance",
  'permanent wave',"rock", 
  'hip pop',"pop", 
  'g funk',"funk", 
  'baroque pop',"pop", 
  'indie pop',"pop",
  'chicago rap',"rap", 
  'indie poptimism',"indie", 
  'french shoegaze',"rock",
  'alternative metal',"metal", 
  'indie folk',"indie", 
  'alternative rock',"rock",
  'uk hip hop',"hip hop", 
  'electro house',"house", 
  'garage rock',"rock", 
  'israeli pop',"pop",
  'alternative r&b',"r&b", 
  'australian pop',"pop", 
  'candy pop',"pop", 
  'modern rock',"rock",
  'conscious hip hop',"hip hop", 
  'folk-pop',"pop", 
  'alternative dance',"dance", 
  'k-pop',"pop",
  'gangster rap',"rap", 
  'brostep',"dance", 
  'downtempo',"pop", 
  'la indie',"indie", 
  'bass trap',"dance",
  'metropopolis',"pop", 
  'electropop',"pop", 
  'electro',"electronica", 
  'destroy techno',"dance", 
  'emo',"rock",
  'austrian pop',"pop", 
  'irish pop',"pop", 
  'adult standards',"pop", 
  'modern folk rock',"rock",
  'tropical house',"house", 
  'contemporary r&b',"r&b", 
  'deep disco house',"house",
  'bubblegum dance',"dance", 
  'chill pop',"pop", 
  'comic',"pop", 
  'complextro',"electronica", 
  'nyc rap',"rap",
  'deep groove house',"house", 
  'australian hip hop',"hip hop", 
  'neo soul',"soul",
  'deep house',"house", 
  'french indie pop',"pop", 
  'german pop',"pop", 
  'dutch hip hop',"hip hop",
  'aussietronica',"electronica", 
  'australian indie',"indie", 
  'canadian contemporary r&b',"r&b",
  'kentucky hip hop',"hip hop", 
  'new jersey rap',"rap", 
  'irish singer-songwriter',"pop",
  'ghanaian hip hop',"hip hop", 
  'icelandic indie',"indie", 
  'indie pop rap',"pop",
  'new french touch',"pop", 
  'san diego rap',"rap", 
  'australian psych',"rock",
  'canadian indie',"indie", 
  'alt z',"pop", 
  'danish pop',"pop", 
  'melodic rap',"rap",
  'social media pop',"pop", 
  'london rap',"rap", 
  'florida rap',"rap", 
  'emo rap',"rap",
  'latin',"dance", 
  'ohio hip hop',"hip hop", 
  'dfw rap',"rap", 
  'hawaiian hip hop',"hio hop",
  'dirty south rap',"rap", 
  'afroswing',"swing", 
  'basshall',"dance", 
  'memphis hip hop',"hip hop",
  'bedroom pop',"pop", 
  'hollywood',"pop", 
  'afrofuturism',"pop", 
  'comedy rap',"rap",
  'colombian pop',"pop", 
  'cali rap',"rap", 
  'black americana',"pop",
  'north carolina hip hop',"hip hop", 
  'alternative pop rock',"pop", 
  'dark clubbing',"dance",
  'lgbtq+ hip hop',"hip hop", 
  'afro dancehall',"dance", 
  'argentine hip hop',"hip hop",
  'classic rock',"rock", 
  'uk drill',"hip hop")
val = 0
while (val <= 258)
{
  tempval <- val
  df["top.genre"][df["top.genre"] == genre_dict[tempval+1]] <-  as.character(genre_dict[tempval+2])
  val = val + 2
}

length(unique(df$top.genre))
```

#### Ordinal Encoder
Now, we will do an ordinal encoder to the variable that will be required to do calculation. This transformation will change the character data type that act as a category to number data type. Here is the function to do the encoding.
```{r}
encode_ordinal <- function(x, order = unique(x)) {
  x <- as.numeric(factor(x, levels = order, exclude = NULL))
  x
}
```
Now we can choose the data that will be encoded. In this case we will encode artist type, 
```{r}
new.col<-encode_ordinal(df[["artist.type"]])
df$artist.type.enc<-new.col
head(df)
```
We will also do the encoder on genre
```{r}
new.col<-encode_ordinal(df[["top.genre"]])
df$top.genre.enc<-new.col
head(df)
```
### 3.4 Dataset for analysis
Dataset we use will be all of the dataset given by the kaggle that has been cleaned. We will copy the data into new dataframe variable to keep the original dataframe. We will also show the preview with each of the class attribute

```{r}
df.song<-df
head(df.song)
sapply(df.song, class)
```


## 4. DATA Analysis
### 4.1 Data Model
We will need 3 types of model data. Which is the original data, first five year data and last five year data. This model will be use for exploratory data analysis.
```{r}
df.song.first <- df.song[ which( df$top.year >= 2010 & df.song$top.year <= 2014),]
df.song.second <- df.song[ which( df$top.year >= 2015 & df.song$top.year <= 2019),]

unique(df.song.first$top.year)
unique(df.song.second$top.year)
```

The other model that we are going to need is model for genre prediction


### 4.2 Data Analysis Method

### 4.3 Data Analysis Result




## 5. D























This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
